2024-07-05 19:52:17,559 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'db.db'} (connection.py:299)
2024-07-05 19:52:17,760 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:301)
2024-07-05 19:52:17,772 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: db.db (connection.py:295)
2024-07-05 19:52:19,923 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema db.sqlmesh__sqlmesh_example (evaluator.py:273)
2024-07-05 19:52:19,924 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1916)
2024-07-05 19:52:19,925 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1916)
2024-07-05 19:52:19,927 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM information_schema.tables WHERE (table_catalog = 'db' AND table_schema = 'sqlmesh__sqlmesh_example') AND table_name IN ('sqlmesh_example__seed_model__1248844913__temp', 'sqlmesh_example__format_columns__1439494916', 'sqlmesh_example__incremental_model__3269816977', 'sqlmesh_example__full_model__3031530868__temp', 'sqlmesh_example__seed_model__1248844913', 'sqlmesh_example__full_model__3031530868', 'sqlmesh_example__incremental_model__3269816977__temp', 'sqlmesh_example__format_columns__1439494916__temp') (base.py:1916)
2024-07-05 19:52:19,970 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh__sqlmesh_example' (evaluator.py:888)
2024-07-05 19:52:19,970 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh__sqlmesh_example" (base.py:1916)
2024-07-05 19:52:19,974 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__format_columns__1439494916__temp' (evaluator.py:1177)
2024-07-05 19:52:19,975 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__format_columns__1439494916__temp" ("id" INT) (base.py:1916)
2024-07-05 19:52:19,976 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dry running model 'sqlmesh_example.format_columns' (evaluator.py:1197)
2024-07-05 19:52:19,976 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CAST("full_model"."item_id" AS INT) AS "id" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__3031530868" AS "full_model" WHERE FALSE LIMIT 0 (base.py:1916)
2024-07-05 19:52:19,979 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__format_columns__1439494916' (evaluator.py:1177)
2024-07-05 19:52:19,980 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__format_columns__1439494916" ("id" INT) (base.py:1916)
2024-07-05 19:52:19,999 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."format_columns": 2026575188> (evaluator.py:487)
2024-07-05 19:52:20,002 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2024-07-02 00:00:00+00:00, 2024-07-03 00:00:00+00:00) into db.sqlmesh__sqlmesh_example.sqlmesh_example__format_columns__1439494916' (evaluator.py:517)
2024-07-05 19:52:20,002 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__format_columns__1439494916" AS SELECT CAST("id" AS INT) AS "id" FROM (SELECT CAST("full_model"."item_id" AS INT) AS "id" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__3031530868" AS "full_model") AS "_subquery" (base.py:1916)
2024-07-05 19:52:20,003 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding interval (1719878400000, 1719964800000) for snapshot SnapshotId<"db"."sqlmesh_example"."format_columns": 2026575188> (engine_adapter.py:603)
2024-07-05 19:52:20,011 - MainThread - sqlmesh.core.state_sync.common - INFO - Promoting environment 'dev' (common.py:123)
2024-07-05 19:52:20,020 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh_example__dev' (evaluator.py:888)
2024-07-05 19:52:20,020 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh_example__dev" (base.py:1916)
2024-07-05 19:52:20,021 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example__dev.format_columns' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__format_columns__1439494916' (evaluator.py:1143)
2024-07-05 19:52:20,021 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "db"."sqlmesh_example__dev"."format_columns" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__format_columns__1439494916" (base.py:1916)
2024-07-05 19:52:20,022 - MainThread - sqlmesh.core.state_sync.common - INFO - Finalizing environment 'dev' (common.py:201)
2024-07-05 19:52:20,037 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
